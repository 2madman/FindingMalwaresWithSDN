rule Detect_Malicious_Strings {
    meta:
        author = "Security Analyst"
        description = "Detects common malicious strings"
        reference = "https://example.com/malware-signature"
    strings:
        $malicious_string1 = "ThisIsAMaliciousString123!"
        $malicious_string2 = "Invoke-Shellcode"
        $malicious_string3 = "malware_command_exec"
    condition:
        any of them
}

rule Detect_Suspicious_API_Calls {
    meta:
        author = "Security Analyst"
        description = "Detects suspicious API calls"
        reference = "https://example.com/malware-signature"
    strings:
        $suspicious_api1 = "RegOpenKeyExA"
        $suspicious_api2 = "CreateRemoteThread"
        $suspicious_api3 = "InternetOpenA"
    condition:
        any of them
}

rule Detect_PE_Header_Signatures {
    meta:
        author = "Security Analyst"
        description = "Detects PE file header signatures"
        reference = "https://example.com/malware-signature"
    strings:
        $pe_header1 = "MZ"
        $pe_header3 = "Rich"
    condition:
        all of them
}

rule Detect_Anti_Analysis_Techniques {
    meta:
        author = "Security Analyst"
        description = "Detects anti-analysis techniques"
        reference = "https://example.com/malware-signature"
    strings:
        $anti_analysis1 = "IsDebuggerPresent"
        $anti_analysis2 = "GetTickCount"
        $anti_analysis3 = "Sleep"
    condition:
        any of them
}

rule Suspicious_Executable_Size {
  meta:
    description = "Detects executables with unusual file size"

  condition:
    filesize > 10MB
}