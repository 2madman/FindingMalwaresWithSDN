from scapy.all import *
import time
from scapy.layers.inet import TCP
from scapy.layers.inet import IP

def send_test_packets(count=250):
    for _ in range(count):
        # Craft a packet with "infpub.dat" payload for port 80
        packet_80 = IP(dst="127.0.0.1") / TCP(dport=80, sport=12345) / Raw(load="GET /infpub.dat HTTP/1.1\r\nHost: example.com\r\n\r\n")
        send(packet_80, verbose=False)
        time.sleep(0.001)  # Small delay to ensure packet ordering

        # Craft a packet with "infpub.dat" payload for port 445
        packet_445 = IP(dst="127.0.0.1") / TCP(dport=445, sport=12345) / Raw(load="infpub.dat")
        send(packet_445, verbose=False)
        time.sleep(0.001)

        # Craft a packet with "infpub.dat" payload for port 139
        packet_139 = IP(dst="127.0.0.1") / TCP(dport=139, sport=12345) / Raw(load="infpub.dat")
        send(packet_139, verbose=False)
        time.sleep(0.001)

send_test_packets()
